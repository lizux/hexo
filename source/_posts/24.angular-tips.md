title: AngularJS使用技巧
date: 2016-01-11
tags: [JavaScript,AngularJS]
---
## 在控制器内访问form对象
AngularJS内置了对form对象的支持，可以在视图中方便对form进行操作，只需要设置form的name属性即可对表单进行验证、提交等相关动作

``` html
<form name="someForm">
    <input type="text" name="title" ng-model="title">
    <button type="submit" ng-click="save(someForm)">保存</button>
</form>
```

但是要在控制器或子级域中访问form对象，就无法像视图中直接用上述方法了，需要做适当修改
改造后：
``` html
<form name="forms.someForm">
    <input type="text" name="title" ng-model="title">
    <button type="submit" ng-click="save(forms.someForm)">保存</button>
</form>
```
``` javascript
$scope.forms = {};
// 控制器初始化时无法访问form对象，需要监听
$scope.$watch('forms.someForm', function(form) {
    if(form) {
        // your code...
    }
});
// 延后操作时form对象已经准备好，没有这个问题
$scope.save($scope.forms.someForm);

```


## IE不支持style属性中书写angular表达式的问题

如下表达式：
``` html
style="width:{{progress}}%"
```
在Firefox、Chrome中正常，在IE中无法正确显示。

这是由于IE加载HTML代码时，认为style属性值是非法的，所以忽略并移除了它，从而导致angularjs无法正确计算并更新。
解决方法：
```
ng-style="{width: progress + '%'}"
```
或
```
ng-attr-style="width: {{value}}%"
```
参考：[github](https://github.com/angular/angular.js/issues/2186)


## input[type=file]元素不支持ng-change指令

如下表达式：
``` html
<input type="file" id="file" name="file" ng-change="fileNameChanged()">
```
是无效的

解决方法：
``` html
<input type="file" id="file" name="file" onchange="angular.element(this).scope().fileNameChanged()">
```


## 在angular中判断某id元素是否存在
因为在angular.element获取某id会返回数组，无法使用空值来进行判断，只能判断数组长度
``` javascript
if ( angular.element('#elementID').length ) {
    console.log('#elementID 存在');
}
```


## 延时触发效果
使用:hover伪类实现一些效果，可以使用transition-delay来延时处理，防止触发太敏感，干扰用户

也可以使用js脚本来实现：
``` javascript
(function($){
    $.fn.hoverDelay = function(options){
        var defaults = {
            hoverDuring: 200,
            outDuring: 200,
            hoverEvent: function(){
                $.noop();
            },
            outEvent: function(){
                $.noop();
            }
        };
        var sets = $.extend(defaults,options || {});
        var hoverTimer, outTimer;
        return $(this).each(function(){
            $(this).hover(function(){
                clearTimeout(outTimer);
                hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
            },function(){
                clearTimeout(hoverTimer);
                outTimer = setTimeout(sets.outEvent, sets.outDuring);
            });
        });
    }
})(jQuery);

$("#test").hoverDelay({
    hoverEvent: function(){
        alert("经过我！");
    }
});
```

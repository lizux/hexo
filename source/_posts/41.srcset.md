
title: 响应式图片设计及 srcset 属性探索
date: 2019-03-05
tags: [HTML,CSS]
---

## 响应式图片设计
在整个网站的开发中，图片的处理是一个无法绕开或忽略的问题。因为，图片要在各种设备上平滑过渡显示，
它们将会碰到的问题有：
0. 优化在不同设备下的观看体验（不同分辨率使用不同布局）
0. 避免浪费带宽（不同分辨率调用不同图片）

第一个问题可以用 CSS 媒体查询解决。而第二个问题，如果是背景图片，也可以用媒体查询；但是对 HTML 里面的 img 标签就无能为力了。这时，`<img>` 元素的 srcset 属性就派上用场了。

```html
<img src="images/demo.jpg" srcset="
images/demo_s.jpg 480w,
images/demo_m.jpg 1024w,
images/demo_l.jpg 1280w,
images/demo_xl.jpg 1440w,
images/demo_xxl.jpg 1920w,
images/demo_xxxl.jpg 5120w
" />
```

### 格式：
srcset 格式为每条规则包含:
0. 一个图片文件名
0. 空格
0. 图像宽度

规则间以逗号分隔
> 注： srcset 生效时，自动忽略 src 属性

### 判断规则：
0. 没有指定单位时，默认为 1x
0. 为 \*x 时，判断设备像素比
0. 为 \*w 时，判断实际像素大小 (设备独立像素 DIPs × 设备像素比 DPR)

> 注： 实际像素 也叫 物理像素，为设备的真实像素
       设备独立像素 也叫 CSS像素，独立于设备用于逻辑上衡量像素而抽象出来的虚拟像素。它是为了兼容不同物理尺寸不同分辨率下统一显示的问题。screen.width 可以获取该值；另外设置了 <meta name="viewport" content="width=device-width"> 时，document.documentElement.clientWidth 值等于该值。

### 判断优先级：
0. 先入规则，优先显示最早满足的条件；
0. 等于规则，优先显示条件相等的;
0. 没有相等的话，会自动选择一个适当的可用图片
	单位是 x 时，规则不明确；
	单位是 w 时，PC 端会选择大于实际像素值的最近节点，移动端会选择和设备像素比的绝对差值为最小的节点。
	> 注：如一移动设备横向分辨率为 1080 像素，DPR 为 3，则 360×3=1080，在1024(2.84)、1139(3.16)时选1024，在1024、1140(3.17)时选1140

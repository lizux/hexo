title: AngularJS 中 $scope 与 controller as 辨析
date: 2015-10-27
tags: [JavaScript,AngularJS]
---
在AngularJS中处理controller时，一直使用官方默认的方式，即将model绑定到$scope：
``` html
<div ng-controller="test1Ctrl">{{text}}</div>
```
``` javascript
angular.module('app').controller('test1Ctrl', ['$scope', function($scope){
    $scope.text = 'hello';
}]);
```

AngularJS v1.2以后，新增了一种写法，controller as，即将model直接绑定到controller的实例上：
``` html
<div ng-controller="test2Ctrl as test">{{test.text}}</div>
```
``` javascript
angular.module('app').controller('test2Ctrl', function(){
    var vm = this;
    vm.text = 'world';
    return vm; //返回该实例，这样即使要改回用默认方法，也很方便直接修改第一句为 var vm = $scope 即可，后面代码不用改动
}]);
```

区别：
0. $scope 方式，在注入时声明，后续就可以直接使用$scope对象；
   controller as方式，在HTML代码里面写别名，定义controller不用显式的依赖$scope，直接对this操作。
   这就变成一个普通的函数定义，即所谓的`POJO（Plain Old Javascript Object）`，与框架无关，只有逻辑。即便不再使用AngularJS，也可以方便快捷地剥离出来。
   由于不依赖$scope，所以也就没法使用$scope的`$watch`、`$on`、`$broadcast`、`$emit`方法。
0. $scope 方式，$scope中的变量和对象可以直接访问，而且也可以访问父级scope的变量、对象（$parentScope）；
   controller as方式，this只能访问当前的作用域，要访问父级的变量，需要通过别名。
0. $scope 方式，直接依赖注入$scope对象，直接访问；
   controller as方式，别名就是定义在$scope上的一个对象，这就是controller的一个实例，在定义controller时绑定到this上的model其实都是绑定该实例的。这样的话，由于没有了原型链继承，有效避免了在嵌套scope的情况下子scope的属性隐藏掉父scope属性的情况。

最后，使用$scope 或contoller as并没有性能上的差别，仅仅是看大家习惯罢了。

注：无论定义controller时有没有直接依赖注入$scope，DOM中的scope是始终存在的。即使使用controller as，双向绑定还是通过$scope的`watch`以及`digest`来实现的。
注：定义route时也能用controller as，route提供了一个`controllerAs`参数

参考：
[AngularJS:this与$scope](http://www.alloyteam.com/2015/04/angularjs-this-yu-scope/)
[用$scope还是用controller as](http://pinkyjie.com/2015/02/09/controller-as-vs-scope/)
